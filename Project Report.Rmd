---
title: "Project-QM"
author: "Karan, Rohit, Shubham"
date: "14/03/2022"
output: pdf_document
---
### Introduction 
1.Role of Weather 
  1.1. Seasonality  
  1.2. Psychological Effect

### Objective
1.Impact of Weather on Retail Sales in 3 major Canadian cities. 
2. Footfall is our proxy variable.
3. Weather Variables -> snow, precipitation, sunlight
### Literature Review
1. Past Articles -1.1 and 1.2
2. How our research is novel?
3. How footfall is related to Sales?
4. Hypotheses : 3/4 depending on independent variables.
5. Control Variables and there importances--- refer to articles
    a. CPI b. unemployability c. disposable income d. consumer confidence 
Talk about all sections of paper- what's done in which section.

### Data Collection and preprocessing 
safegraph
statista.ca 
Python/ R preprocessing

```{r, error=FALSE}
library(tidyverse)
library(readxl)

df_cpi = read_excel("Data/controlVariables.xlsx", sheet= "CPI Index") #CPI Index
df_unemployability = read_excel("Data/controlVariables.xlsx", sheet= "UnemploymentRate") #Unemployability
df_income =  read_excel("Data/controlVariables.xlsx", sheet= "DisposableIncome")%>%
  select(Date, `British Columbia`, Ontario, Quebec) #Disposable Income
df_cc =  read_excel("Data/controlVariables.xlsx", sheet= "ConsumerConfidence") #Consumer Confidence

df_footfall = read.csv("Data/footfallFinal.csv")
df_weather = read.csv("Data/weatherDataFinal.csv")

df_weather <- df_weather %>% 
              select(date, max_temp, mean_temp, snow_grnd, spd_max_gust, total_rain,total_snow, total_precip, postal_code)

df_cpi <- df_cpi %>% pivot_longer(!Date, names_to = "region", values_to = "cpi")
df_unemployability <- df_unemployability %>% pivot_longer(!Date, names_to = "region", values_to = "unemployability")
df_income <- df_income %>% pivot_longer(!Date, names_to = "region", values_to = "disposableIncome")
df_cc <- df_cc %>% pivot_longer(!Date, names_to = "region", values_to = "ConsumerConfidence")

df_cpi <- df_cpi %>% separate(Date, c("Year", "Month"))
df_unemployability <- df_unemployability %>% separate(Date, c("Year", "Month"))
df_income <- df_income %>% rename(Year = Date)
df_cc <- df_cc %>% separate(Date, c("Year", "Month"))

df_control <- merge(df_cc, df_cpi, by = c("region", "Year", "Month"))
df_control <- merge(df_control, df_income, by = c("region", "Year"))
df_control <- merge(df_control, df_unemployability, by = c("region", "Year", "Month"))

df_control <- df_control %>% mutate(region = case_when(region == "British Columbia" ~ "BC",
                                                       region == "Ontario" ~ "ON",
                                                       region == "Quebec" ~ "QC"))

df_footfall <- df_footfall %>% select(Date, visits_by_day, region, postal_code) %>% rename(date = Date)
data <- merge(df_footfall, df_weather, by = c("postal_code", "date"))
data <- data %>% separate(date, c("Year", "Month", "Day"))
data <- merge(data, df_control, by = c("region", "Year", "Month"), all.x = TRUE)
```

### EDA


### Modelling


### Results


### Conclusion